<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout/base :: layout(
        pageTitle='회원 탈퇴 처리 중',
        bodyClass='state-guest',
        content=~{::#page-content},
        styles=~{::#page-styles},
        scripts=~{::#page-scripts}
      )}">

<head>
    <th:block id="page-styles"></th:block>
</head>

<body>

<main id="page-content">
    <section class="container" style="text-align:center; padding:80px 0;">
        <h2 class="section__title">회원 탈퇴 처리 중...</h2>
        <p style="color:#6b7280; font-size:17px;">
            안전하게 로그아웃하고 있습니다. 잠시만 기다려주세요.
        </p>
    </section>
</main>

<th:block id="page-scripts">
    <script th:inline="javascript">
        (async function () {

            try {
                // '/api/auth/logout' API 호출 (서버의 HttpOnly 쿠키 삭제)
                await fetch('/api/auth/logout', {
                    method: 'POST'
                });
            } catch (error) {
                console.error("Logout API call failed during withdrawal:", error);
                // API 호출에 실패하더라도 클라이언트 측 정보는 무조건 삭제
            }
            localStorage.removeItem('userName');
            localStorage.removeItem('userRole');

            window.location.replace('/');

        })();
    </script>
</th:block>

</body>
</html>